<html>
<head>
<title>undvd user guide</title>
<style type="text/css">
body, td {
font-family: DejaVu Sans, Bitstream Vera Sans, Verdana;
font-size: 10pt; }

h2 {
font-size: 140%;
padding: 3px;
background-color: #ed7; }

h3 {
font-size: 125%; }

table {
margin: 1px; }

table, td {
font-family: DejaVu Sans Mono, Bitstream Vera Sans Mono, Monospace;
padding: 0px 10px 0px 10px; }

dt {
font-weight: bold; }

dd {
padding-bottom: 5px; }

c {
font-family: DejaVu Sans Mono, Bitstream Vera Sans Mono, Monospace;
font-weight: bold;
color: navy; }

code {
font-family: DejaVu Sans Mono, Bitstream Vera Sans Mono, Monospace;
font-weight: bold;
color: navy;
background-color: #eeb;
border: 1px dotted #aaa;
padding: 4px;
margin: 3px; }

e {
font-style: italic; }

h {
font-weight: bold;
color: green; }
</style>
</head>

<body>
<h1>undvd user guide</h1>

<p>Most dvd rippers give you so many options and settings that it takes 45 minutes to set it up before you can start ripping, and you're still not sure if you chose the right settings. undvd is based on the principle of <e>sensible defaults</e> - it makes those decisions for you, making ripping dvds easy.</p>

<p>A dvd consists of a number of <e>titles</e> (videos), each of which can have several <e>audio tracks</e> and <e>subtitles</e>. When ripping, you have to select which of each to use. Unfortunately, titles on a dvd don't contain any names that would suggest what they are (the movie? a trailer? director's cut?), and so they computer doesn't know. But you can probably figure out what is what by looking at the lenght of the title.</p>


<h2>Quick start</h2>

<ol>
<li>Run <c>scandvd.sh</c> to list all the titles on the disc.
<li>If in doubt about what the titles are, play with mplayer: <c>mplayer dvd://01</c>
<li>Run <c>undvd.sh -t <h>01</h> -a <h>en</h> -s <h>es</h></c> to rip only the <e>first</e> title, with <e>English</e> audio and <e>Spanish</e> subtitles.
</ol>


<h2>Prerequisites</h2>
undvd depends on a few programs to run, so make sure you have this:
<ul>
<li><a href="http://www.gnu.org/software/coreutils/">coreutils</a>
<li><a href="http://www.gnu.org/software/bash/">bash</a>
<li><a href="http://www.gnu.org/software/findutils/">findutils</a>
<li><a href="http://www.gnu.org/software/gawk/">gawk</a>
<li><a href="http://www.gnu.org/software/grep/">grep</a>
<li><a href="http://procps.sourceforge.net/">procps</a>
<li><a href="http://www.gnu.org/software/sed/">sed</a>
<li><a href="http://untrepid.com/lsdvd/">lsdvd</a>
<li><a href="http://www.mplayerhq.hu/">mplayer</a> with mencoder and support for
	<ul>
	<li><a href="http://www.dtek.chalmers.se/groups/dvd/">dvdread</a>
	<li><a href="http://lame.sourceforge.net">mp3</a> (lame)
	<li><a href="http://developers.videolan.org/x264.html">x264</a>
	<li><a href="http://www.xvid.org">xvid</a>
	</ul>
</ul>


<h2>Diving in</h2>

<h3>Find out which title(s) to rip</h3>

<p><c>scandvd.sh</c> uses <e>lsdvd</e> to print a list of titles on the disc. Each line in the output looks like this:</p>

<table><tr>
<td>03</td>
<td><c>length:</c> <h>00:22:06</h></td>
<td><c>audio:</c> en es</td>
<td><c>subtitles:</c> en es nl</td>
</tr></table>

<p>This particular title has two audio tracks and three subtitles. You can also tell <c>scandvd.sh</c> which device to scan:</p>

<code>scandvd.sh -d <h>/dev/dvd</h></code>

<p>Or, if you already have the dvd mounted, you can give it a path:</p>

<code>scandvd.sh -q <h>/path</h></code>

<p>Or, if you have an iso image you want to rip from:</p>

<code>scandvd.sh -i <h>disc.iso</h></code>


<h3>Rip titles</h3>

<p>Once you know which titles to rip, run <c>undvd.sh</c>, where the first argument is the title(s), the second is the audio, the third is the subtitles (the rest are optional):</p>

<p><c>undvd.sh -t <h>01,02,03</h> -a <h>en</h> -s <h>es</h> [-e <h>200</h>] [-d <h>/dev/dvd</h>] [more options]</c></p>

<table>
<tr><td><c>-t<c></td><td>titles to rip (comma separated)</td></tr>
<tr><td><c>-a<c></td><td>audio language (two letter code, eg. <h>en</h>)</td></tr>
<tr><td><c>-s<c></td><td>subtitle language (two letter code or <h>off</h>)</td></tr>
<tr><td><c>-d<c></td><td>dvd device to rip from (default is <h>/dev/dvd</h>)</td></tr>
<tr><td><c>-q<c></td><td>dvd directory to rip from</td></tr>
<tr><td><c>-i<c></td><td>dvd iso image to rip from</td></tr>
<tr><td><c>-e<c></td><td>exit after this many seconds (usually for testing)</td></tr>
<tr><td><c>-c<c></td><td>do sanity check (check for missing tools)</td></tr>
<tr><td><c>-z<c></td><td>&lt;show advanced options&gt;</td></tr>
</table>

<p>So to rip the <i>first</i> title with <i>English</i> audio and no subtitles from a dvd (assuming your dvd device is called /dev/dvd) you would run:</p>

<code>undvd.sh -t <h>01</h> -a <h>en</h> -s <h>off</h> -d <h>/dev/dvd</h></code>

<p>Normally, you omit the <c>-e</c> parameter, but it's useful if you want to just rip a small part of the title to see that it works and that it looks good.</p>

<p><c>undvd.sh</c> first copies the entire disc to the harddisk with <e>dd</e>. It then encodes the title(s) with <e>mencoder</e>, part of <e>mplayer</e>. The output format uses <a href="http://en.wikipedia.org/wiki/H264">x264</a> compression (optionally xvid) for the video and mp3 for the audio.</p>


<h3>Advanced options</h3>

The above options are sufficient to get a good quality rip, but if you need more control over the process, there are some extra options you can set.

<p><c>undvd.sh -t <h>01,02,03</h> -a <h>en</h> -s <h>es</h> [-e <h>200</h>] [-d <h>/dev/dvd</h>] [more options]</c></p>

<table>
<tr><td><c>-o<c></td><td>output file size in mb (integer value)</td></tr>
<tr><td><c>-1<c></td><td>force 1-pass encoding</td></tr>
<tr><td><c>-2<c></td><td>force 2-pass encoding</td></tr>
<tr><td><c>-r<c></td><td>scale video to width (integer value)</td></tr>
<tr><td><c>-f<c></td><td>use picture smoothing filter (not recommended for top quality source content)</td></tr>
<tr><td><c>-x<c></td><td>use xvid compression (faster, slightly lower quality)</td></tr>
</table>


<h2>How long does it take?</h2>

<p>This depends mostly on your cpu. Copying the dvd to disk can take about <e>10-15 minutes</e>. Encoding the video can take about <e>2-5 minutes per minute of video</e> (so for a 2 hour movie - 4h-10h).</p>

<p><c>undvd.sh</c> uses <e>mencoder</e>'s estimate to give you an idea of how long it takes. For every title it displays a line like this:</p>

<table><tr>
<td><h>[-]</h></td>
<td>Encoding, to monitor log:</td>
<td>tail -F logs/01.log</td>
<td><h>+101min</h></td>
<td><h>-44min</h></td>
</tr></table>

<p>Here track <e>01</e> is being ripped and it has been running for <e>101</e> minutes. The estimated time to completion is <e>44</e> minutes. For more detailed information, have a look at the log file, which displays line like this:</p>

<table><tr>
<td>Pos: <h>54.5s</h></td>
<td>1367f ( <h>3%</h>)</td>
<td><h>13fps</h></td>
<td>Trem:  <h>44min</h></td>
<td><h>277mb</h></td>
</tr></table>

<p>At this point, 54.5 seconds of video have been processed, which is 3% of the title. The current rate is 13 frames/second (normally there are about 25 fps in a movie), and the time remaining is estimated to 44 minutes. The output file is estimated at 277mb.</p>

<p><b>Note:</b> <c>undvd.sh</c> runs at the lowest priority, so it should not interfere with use of your computer, it just runs in the background. (The less you use computer the faster it will run :-)</p>


<h2>Problems?</h2>

<dl>
<dt>Q. When I preview a file in progress, the video is out of sync with the audio.
<dd>A. Wait until it's finished, then it should be fine.

<dt>Q. What is the difference between x264 and xvid encoding?
<dd>A. Xvid can be up to 30% faster, and produces very good results when the source video isn't that high quality (eg. remastered old tv-shows). But for movies of top quality, the picture is better with x264.

<dt>Q. What's the picture smoothing filter?
<dd>A. Source content with certain imperfections tends to look better smoothed before encoded. The filter slows down encoding, so you might want to rip a small part of the video first to see if it's worth it.

<dt>Q. When I play the movie in xine/totem/kaffeine I see patches of green color.
<dd>A. This is a known bug in xine. See <a href="http://sourceforge.net/tracker/index.php?func=detail&aid=1754446&group_id=9655&atid=109655">this bug</a>.
</dl>


<h2>Background</h2>
<ol>
<li><a href="http://www.matusiak.eu/numerodix/blog/index.php/2007/01/30/undvd-dvd-ripping-made-easy/">Motivation for undvd</a>
<li><a href="http://www.matusiak.eu/numerodix/blog/index.php/2007/12/11/undvd-looking-ahead-and-back/">Design decisions and behavior</a>
</ol>


<h2>Reference (the hairy details)</h2>
<ul>
<li>mencoder general resources
	<ol>
	<li><a href="http://gentoo-wiki.com/HOWTO_Rip_DVD_mencoder">HOWTO Rip DVD mencoder [gentoo-wiki]</a>
	</ol>

<li>x264 info
	<ol>
	<li><a href="http://www.mplayerhq.hu/DOCS/HTML/en/menc-feat-quicktime-7.html">Using MEncoder to create QuickTime-compatible files [mplayerhq]</a>
	<li><a href="http://www.softlab.ntua.gr/~ttsiod/x264.html">MPEG-2 (DVD) transcoding to H.264 under UNIX</a>
	</ol>

<li>xvid info
	<ol>
	<li><a href="http://gentoo-wiki.com/HOWTO_Mencoder_Introduction_Guide#XviD">HOWTO Mencoder Introduction Guide [gentoo-wiki]</a>
	<li><a href="http://www.mplayerhq.hu/DOCS/HTML/en/menc-feat-xvid.html">Encoding with the Xvid  codec [mplayerhq]</a>
	</ol>
</ul>


<h2>Changelog</h2>
<ul>
	<li>0.3.0
	<ul>
		<li> User set bitrate. Bitrate can now be set implicitly by setting an output filesize for the video with the -o switch.
		<li> 2-pass encoding. 2-pass encoding is done automatically if the bitrate is set below the default. But 1-pass or 2-pass encoding can always be overriden by using -1 and -2.
		<li> New system sanity check. undvd can now check for all programs it needs by supplying the -c switch. It also checks for codec support.
	</ul>
	<li>0.2.2
	<ul>
		<li> New install script. While there was no official way of "installing" undvd there is now a makefile with an "install" target, therefore "make install" will deploy the files into the filesystem.
		<li> Distribution specific packages:
		<br/>+ gentoo ebuild
		<br/>+ ubuntu .deb
		<br/>+ fedora .rpm
		<br/>These are all brand new and not well tested.
	</ul>
</ul>


<hr>
# Author: Martin Matusiak &lt;numerodix@gmail.com&gt;
<br># Licensed under the GNU Public License, version 3.

</body>
</html>
